<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <link rel="icon" type="image/x-icon" href="lib/favicon.ico">
        <link rel='stylesheet' href='lib/cswm.css' type='text/css' media='all' />
        <link rel="stylesheet" href="lib/test.css" type="text/css" media="all" />
        <style type="text/css" media="screen">
            html,
            body,
            #content {
                background: #f7f8f8;
                height:100%;
            }
            body {
                margin:0;
                padding:0;
                overflow:hidden;
                background: #f7f8f8;
            }
            #altContent {
                /* style alt content */
            }
            .container--main {
                width: 100%;
            }
            .visually-hidden {
                position: absolute !important;
                clip: rect(1px 1px, 1px, 1px);
                clip: rect(1px, 1px, 1px, 1px);
                padding: 0 !important;
                border: 0 !important;
                height: 1px !important;
                width: 1px !important;
                overflow: hidden;
            }
            #deployJavaPlugin {
                display : none;
            }
        </style>
        <script type="text/javascript" src="swfobject/swfobject.js"></script>
        <script src="lib/deployJava.js?v=VERSION" language="javascript"></script>
        <script type="text/javascript">
            var useHtml5Client = false;

            function getParameterByName(name) {
                name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
                var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                    results = regex.exec(location.search);
                return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
            }

            if (getParameterByName('usehtml5') == 'true') {
                useHtml5Client = true;
                $('altFlash').attr('id', 'altFlash-s');
            }

            // Check for Firefox 41.0.1/2 to workaround Flash hang
            // See https://bugzilla.mozilla.org/show_bug.cgi?id=1210665
            var ffHangWorkaround = function() {
                if (navigator.userAgent.indexOf("Windows") != -1 &&
                    (navigator.userAgent.indexOf("Firefox/41.0") != -1 &&
                        navigator.buildID > "20150928" &&
                        navigator.buildID < "20151015")) {
                        console.log("Browser appears to be Firefox 41.0.1 or .2 on Windows");
                        return true;
                }
                return false;
            };

            //swfobject.registerObject("BigBlueButton", "11", "expressInstall.swf");
            var flashvars = {};
            var params = {};
            params.quality = "high";
            params.bgcolor = "#869ca7";
            params.allowfullscreen = "true";
            if (ffHangWorkaround()) {
                console.log("Applying Firefox Flash hang workaround");
        // wmode = opaque causes button clicks to be sometimes unresponsive,
        // and right-click in particular is unreliable. It disables Flash
        // permission prompts on Linux (causing webcams, flash voice to be
        // unusable there). But it's better than a browser hang...
                params.wmode = "opaque";
            } else {
                params.wmode = "window";
            }
            params.allowscriptaccess = "true";
            params.seamlesstabbing = "true";
            var attributes = {};
            attributes.id = "BigBlueButton";
            attributes.name = "BigBlueButton";
            attributes.align = "middle";
            attributes.tabIndex = 0;
            swfobject.embedSWF("BigBlueButton.swf?v=VERSION", "altFlash", "100%", "100%", "11.0.0", "expressInstall.swf", flashvars, params, attributes, embedCallback);

            function embedCallback(e) {
                // Work around pixel alignment bug with Chrome 21 on Mac.
                // See: http://code.google.com/p/bigbluebutton/issues/detail?id=1294
                var objs = $('object');
                objs.each(function(i, o) {
                    var o = $(o);
                    var top = o.offset().top;
                    var left = o.offset().left;
                    var roundtop = Math.round(top);
                    var roundleft = Math.round(left);
                    o.css("position", "relative");
                    if (roundtop === top) {
                    } else {
                        o.css("top", roundtop - top);
                    }
                    if (roundleft === left) {
                    } else {
                        o.css("left", roundleft - left);
                    }
                });
            }
        </script>
        <script src="lib/jquery-1.5.1.min.js?v=VERSION" language="javascript"></script>
        <script src="lib/bbblogger.js?v=VERSION" language="javascript"></script>
        <script src="lib/bigbluebutton.js?v=VERSION" language="javascript"></script>
        <script src="lib/bbb_localization.js?v=VERSION" language="javascript"></script>
        <script src="lib/bbb_blinker.js?v=VERSION" language="javascript"></script>
        <script src="lib/bbb_deskshare.js?v=VERSION" language="javascript"></script>
        <script src="lib/bbb_api_bridge.js?v=VERSION" language="javascript"></script>
        <script src="lib/sip.js?v=VERSION" language="javascript"></script>
        <script src="lib/bbb_webrtc_bridge_sip.js?v=VERSION" language="javascript"></script>
        <script src="lib/weburl_regex.js?v=VERSION" language="javascript"></script>
        <script src="lib/jsnlog.min.js?v=VERSION" language="javascript"></script>
        <script>
            window.chatLinkClicked = function(url) {
                window.open(url, '_blank');
                window.focus();
            }
        </script>
        <script type="text/javascript">
            window.onload = function() {
                var checkRequest = $.ajax({
                     dataType: 'json',
                     url: '/html5client/check'
                });
                checkRequest.done(function(data) {
                    if(typeof data.html5clientStatus !== "undefined" && data.html5clientStatus === "running") {
                        document.getElementById('html5Section').style.display='inherit';

                        window.mobileAndTabletCheck = function() {
                          var check = false;
                          (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check = true})(navigator.userAgent||navigator.vendor||window.opera);
                          return check;
                        }

                        if (window.mobileAndTabletCheck() || getParameterByName('usehtml5') == 'true') {
                            console.log('HTML5 compatible browser detected.');
                            $('#html5Section button').trigger('click');
                        }
                    }
                });
            };

            function html5() {
                // no Flash detected on the client
                var originalPath, enterRequest, authToken, meetingId, userId;
                originalPath = document.location.pathname;

                // use the enter api to detect the meetingid, userid and authToken
                // and reuse them to join via the HTML5 client
                enterRequest = $.ajax({
                     dataType: 'json',
                     url: '/bigbluebutton/api/enter'
                });

                enterRequest.done(function(enterData) {
                    meetingId = enterData.response.meetingID;
                    userId = enterData.response.externUserID;
                    authToken = enterData.response.authToken;

                    if ((meetingId != null) && (userId != null) && (authToken != null)) {
                        // redirect to the html5 client with the received info
                        // format <IP>/html5client/<meetingId>/<userId>/<authToken>
                        document.location.pathname = "/html5client/"+meetingId+"/"+userId+"/"+authToken;
                    } else {
                        // go back to the redirection page
                        document.location.pathname = originalPath;
                    }
                });

                enterRequest.fail(function(enterData, textStatus, errorThrown){
                    BBBLog.debug("Enter request failed");
                });
            }
        </script>
    </head>

    <body>
        <div>
            <audio id="remote-media" autoplay="autoplay"></audio>
        </div>

        <div id="content">
            <div id="altFlash" style="width:50%; margin-left: auto; margin-right: auto; ">
                <div class="wrap-around">
                    <div class="wrap container container--main">
                        <div class="main-logo text-center">
                            <a href="http://www.childrenssocialworkmatters.org">
                                <img src="lib/logo.png" alt="Your Childrens Social Work Matters">
                            </a>
                        </div>

                        <div class="page-header">
                            <div class="row">
                                <div class="col-sm-12">
                                    <h1 class="page-header__title">
                                        CSWM Webinar
                                        <br />
                                    </h1>
                                </div>
                            </div>
                        </div>
                        <br/>
                        <div style="margin-left: auto; margin-right: auto;" class="text-center">
                            <div class="alert alert-danger">
                                You are currently using an unsupported or do not have flash installed.<br />
                                Please upgrade your browser or install flash.
                            </div>
                            <div id="html5Section" style="display:none">
                                <div class="alert alert-success">If you are on an mobile device and ar not automatically redirect to the HTML5 application, please click the button below.</div>
                                <button type="button" onclick="html5();" class="btn btn-success">
                                    Launch the HTML5 client &raquo;
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button id="enterFlash" type="button" class="visually-hidden" onclick="startFlashFocus();" value="Click to focus the client"></button>
        <div id="clientReady" aria-atomic="false" aria-live="polite"></div>
    </body>
</html>