{"source":"__coffeescriptShare = typeof __coffeescriptShare === 'object' ? __coffeescriptShare : {}; var share = __coffeescriptShare;\nTemplate.displayUserIcons.events({\n  'click .muteIcon': function(event) {\n    return toggleMic(this);\n  },\n  'click .raisedHandIcon': function(event) {\n    return BBB.lowerHand(getInSession(\"meetingId\"), this.userId, getInSession(\"userId\"), getInSession(\"authToken\"));\n  }\n});\n\nTemplate.displayUserIcons.helpers({\n  userLockedIconApplicable: function(userId) {\n    var lockInAction, locked, ref, ref1, settings;\n    locked = (ref = BBB.getUser(userId)) != null ? ref.user.locked : void 0;\n    settings = (ref1 = Meteor.Meetings.findOne()) != null ? ref1.roomLockSettings : void 0;\n    lockInAction = settings.disablePrivateChat || settings.disableCam || settings.disableMic || settings.lockedLayout || settings.disablePublicChat;\n    return locked && lockInAction;\n  }\n});\n\nTemplate.usernameEntry.events({\n  'click .usernameEntry': function(event) {\n    var ref, userIdSelected;\n    userIdSelected = this.userId;\n    if (userIdSelected !== null) {\n      if (userIdSelected === ((ref = BBB.getCurrentUser()) != null ? ref.userId : void 0)) {\n        setInSession(\"inChatWith\", \"PUBLIC_CHAT\");\n      } else {\n        setInSession(\"inChatWith\", userIdSelected);\n      }\n    }\n    if (isPortrait() || isPortraitMobile()) {\n      toggleUserlistMenu();\n      toggleLeftHamburderIcon();\n      toggleShield();\n    }\n    return setTimeout(function() {\n      return $(\"#newMessageInput\").focus();\n    }, 0);\n  },\n  'click .gotUnreadMail': function(event) {\n    var _id, _this, chat, chats, currentId, i, len;\n    _this = this;\n    currentId = getInSession('userId');\n    if (currentId !== void 0 && currentId === _this.userId) {\n      _id = \"PUBLIC_CHAT\";\n    } else {\n      _id = _this.userId;\n    }\n    chats = getInSession('chats');\n    if (chats !== void 0) {\n      for (i = 0, len = chats.length; i < len; i++) {\n        chat = chats[i];\n        if (chat.userId === _id) {\n          chat.gotMail = false;\n          chat.number = 0;\n          break;\n        }\n      }\n      return setInSession('chats', chats);\n    }\n  }\n});\n\nTemplate.usernameEntry.helpers({\n  hasGotUnreadMailClass: function(userId) {\n    var chat, chats, i, len;\n    chats = getInSession('chats');\n    if (chats !== void 0) {\n      for (i = 0, len = chats.length; i < len; i++) {\n        chat = chats[i];\n        if (chat.userId === userId && chat.gotMail) {\n          return true;\n        }\n      }\n    }\n    return false;\n  },\n  getNumberOfUnreadMessages: function(userId) {\n    var chat, chats, i, len;\n    chats = getInSession('chats');\n    if (chats !== void 0) {\n      for (i = 0, len = chats.length; i < len; i++) {\n        chat = chats[i];\n        if (chat.userId === userId && chat.gotMail) {\n          if (chat.number > 9) {\n            return \"9+\";\n          } else {\n            return chat.number;\n          }\n        }\n      }\n    }\n  }\n});\n","sourceMap":{"version":3,"file":"/client/views/users/user_item.coffee.js","sourceRoot":"","sources":["/client/views/users/user_item.coffee"],"names":[],"mappings":"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","sourcesContent":["Template.displayUserIcons.events\n  'click .muteIcon': (event) ->\n    toggleMic @\n\n  'click .raisedHandIcon': (event) ->\n    # the function to call 'userLowerHand'\n    # the meeting id\n    # the _id of the person whose land is to be lowered\n    # the userId of the person who is lowering the hand\n    BBB.lowerHand(getInSession(\"meetingId\"), @userId, getInSession(\"userId\"), getInSession(\"authToken\"))\n\nTemplate.displayUserIcons.helpers\n  userLockedIconApplicable: (userId) ->\n    # the lock settings affect the user (and requiire a lock icon) if\n    # the user is set to be locked and there is a relevant lock in place\n    locked = BBB.getUser(userId)?.user.locked\n    settings = Meteor.Meetings.findOne()?.roomLockSettings\n    lockInAction = settings.disablePrivateChat or\n                    settings.disableCam or\n                    settings.disableMic or\n                    settings.lockedLayout or\n                    settings.disablePublicChat\n    return locked and lockInAction\n\n# Opens a private chat tab when a username from the userlist is clicked\nTemplate.usernameEntry.events\n  'click .usernameEntry': (event) ->\n    userIdSelected = @.userId\n    unless userIdSelected is null\n      if userIdSelected is BBB.getCurrentUser()?.userId\n        setInSession \"inChatWith\", \"PUBLIC_CHAT\"\n      else\n        setInSession \"inChatWith\", userIdSelected\n    if isPortrait() or isPortraitMobile()\n      toggleUserlistMenu()\n      toggleLeftHamburderIcon()\n      toggleShield()\n    setTimeout () -> # waits until the end of execution queue\n      $(\"#newMessageInput\").focus()\n    , 0\n\n  'click .gotUnreadMail': (event) ->\n    _this = @\n    currentId = getInSession('userId')\n    if currentId isnt undefined and currentId is _this.userId\n      _id = \"PUBLIC_CHAT\"\n    else\n      _id = _this.userId\n    chats = getInSession('chats')\n    if chats isnt undefined\n      for chat in chats\n        if chat.userId is _id\n          chat.gotMail = false\n          chat.number = 0\n          break\n      setInSession 'chats', chats\n\nTemplate.usernameEntry.helpers\n  hasGotUnreadMailClass: (userId) ->\n    chats = getInSession('chats')\n    if chats isnt undefined\n      for chat in chats\n        if chat.userId is userId and chat.gotMail\n          return true\n    return false\n\n  getNumberOfUnreadMessages: (userId) ->\n    chats = getInSession('chats')\n    if chats isnt undefined\n      for chat in chats\n        if chat.userId is userId and chat.gotMail\n          if chat.number > 9\n            return \"9+\"\n          else\n            return chat.number\n    return\n"]}}