{"source":"__coffeescriptShare = typeof __coffeescriptShare === 'object' ? __coffeescriptShare : {}; var share = __coffeescriptShare;\nvar fakeUpload;\n\nthis.scaleWhiteboard = function(callback) {\n  var adjustedDimensions, wpm;\n  adjustedDimensions = scaleSlide(getInSession('slideOriginalWidth'), getInSession('slideOriginalHeight'));\n  wpm = whiteboardPaperModel;\n  wpm.scale(adjustedDimensions.width, adjustedDimensions.height);\n  if (callback) {\n    return callback();\n  }\n};\n\nTemplate.whiteboard.helpers({\n  presentationProgress: function() {\n    var currentPresentation, currentSlideNum, ref, ref1, totalSlideNum;\n    currentPresentation = Meteor.Presentations.findOne({\n      'presentation.current': true\n    });\n    currentSlideNum = (ref = Meteor.Slides.findOne({\n      'presentationId': currentPresentation != null ? currentPresentation.presentation.id : void 0,\n      'slide.current': true\n    })) != null ? ref.slide.num : void 0;\n    totalSlideNum = (ref1 = Meteor.Slides.find({\n      'presentationId': currentPresentation != null ? currentPresentation.presentation.id : void 0\n    })) != null ? ref1.count() : void 0;\n    console.log('slide', currentSlideNum);\n    if (currentSlideNum !== void 0) {\n      return currentSlideNum + \"/\" + totalSlideNum;\n    } else {\n      return '';\n    }\n  },\n  isPollStarted: function() {\n    if (BBB.isPollGoing(getInSession('userId'))) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n  hasNoPresentation: function() {\n    return Meteor.Presentations.findOne({\n      'presentation.current': true\n    });\n  }\n});\n\nTemplate.whiteboard.events({\n  'click .whiteboardFullscreenButton': function(event, template) {\n    return enterWhiteboardFullscreen();\n  },\n  'click .exitFullscreenButton': function(event, template) {\n    if (document.exitFullscreen) {\n      return document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) {\n      return document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) {\n      return document.webkitExitFullscreen();\n    }\n  },\n  'click .sadEmojiButton.inactiveEmojiButton': function(event) {\n    if ($('.sadEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"sad\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .happyEmojiButton.inactiveEmojiButton': function(event) {\n    if ($('.happyEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"happy\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .confusedEmojiButton.inactiveEmojiButton': function(event) {\n    if ($('.confusedEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"confused\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .neutralEmojiButton.inactiveEmojiButton': function(event) {\n    if ($('.neutralEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"neutral\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .awayEmojiButton.inactiveEmojiButton': function(event) {\n    if ($('.awayEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"away\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .raiseHandEmojiButton.inactiveEmojiButton': function(event) {\n    if ($('.raiseHandEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"raiseHand\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .activeEmojiButton': function(event) {\n    if ($('.activeEmojiButton').css('opacity') === '1') {\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"none\");\n      $('.FABTriggerButton').blur();\n      return toggleEmojisFAB();\n    }\n  },\n  'click .FABTriggerButton': function(event) {\n    $('.FABTriggerButton').blur();\n    return toggleEmojisFAB();\n  }\n});\n\nTemplate.whiteboardControls.events({\n  'click .whiteboard-buttons-slide > .prev': function(event) {\n    return BBB.goToPreviousPage();\n  },\n  'click .whiteboard-buttons-slide > .next': function(event) {\n    return BBB.goToNextPage();\n  },\n  'click .switchSlideButton': function(event) {\n    return $('.tooltip').hide();\n  }\n});\n\nTemplate.polling.events({\n  'click .pollButtons': function(event) {\n    var _id, _key;\n    _key = this.label;\n    _id = this.answer;\n    return BBB.sendPollResponseMessage(_key, _id);\n  }\n});\n\nTemplate.polling.rendered = function() {\n  return scaleWhiteboard();\n};\n\nTemplate.polling.destroyed = function() {\n  return setTimeout(scaleWhiteboard, 0);\n};\n\nTemplate.whiteboardControls.rendered = function() {\n  return scaleWhiteboard();\n};\n\nTemplate.whiteboardControls.destroyed = function() {\n  return setTimeout(scaleWhiteboard, 0);\n};\n\nTemplate.whiteboard.rendered = function() {\n  $('#whiteboard').resizable({\n    handles: 'e',\n    minWidth: 150,\n    resize: function() {\n      return adjustChatInputHeight();\n    },\n    start: function() {\n      if ($('#chat').width() / $('#panels').width() > 0.2) {\n        return $('#whiteboard').resizable('option', 'maxWidth', $('#panels').width() - 200);\n      } else {\n        return $('#whiteboard').resizable('option', 'maxWidth', $('#whiteboard').width());\n      }\n    },\n    stop: function() {\n      $('#whiteboard').css('width', 100 * $('#whiteboard').width() / $('#panels').width() + '%');\n      return $('#whiteboard').resizable('option', 'maxWidth', null);\n    }\n  });\n  Meteor.NotificationControl = new NotificationControl('notificationArea');\n  return $(document).foundation();\n};\n\nTemplate.presenterUploaderControl.created = function() {\n  this.isOpen = new ReactiveVar(false);\n  this.files = new ReactiveList({\n    sort: function(a, b) {\n      var ref, ref1;\n      return (ref = a.isUploading === b.isUploading) != null ? ref : {\n        0: (ref1 = a.isUploading) != null ? ref1 : -{\n          1: 1\n        }\n      };\n    }\n  });\n  return this.presentations = Meteor.Presentations.find({}, {\n    sort: {\n      'presentation.current': -1,\n      'presentation.name': 1\n    },\n    fields: {\n      'presentation': 1\n    }\n  });\n};\n\nfakeUpload = function(file, list) {\n  return setTimeout((function() {\n    file.uploadedSize = file.uploadedSize + (Math.floor(Math.random() * file.size + file.uploadedSize) / 10);\n    if (!(file.size > file.uploadedSize)) {\n      file.uploadedSize = file.size;\n      file.isUploading = false;\n    }\n    list.update(file.name, file);\n    if (file.isUploading === true) {\n      return fakeUpload(file, list);\n    } else {\n      return list.remove(file.name);\n    }\n  }), 200);\n};\n\nTemplate.presenterUploaderControl.events({\n  'click .js-open': function(event, template) {\n    return template.isOpen.set(true);\n  },\n  'click .js-close': function(event, template) {\n    return template.isOpen.set(false);\n  },\n  'dragover [data-dropzone]': function(e) {\n    e.preventDefault();\n    return $(e.currentTarget).addClass('hover');\n  },\n  'dragleave [data-dropzone]': function(e) {\n    e.preventDefault();\n    return $(e.currentTarget).removeClass('hover');\n  },\n  'drop [data-dropzone], change [data-dropzone] > input[type=\"file\"]': function(e, template) {\n    var files;\n    e.preventDefault();\n    files = (e.originalEvent.dataTransfer || e.originalEvent.target).files;\n    return _.each(files, function(file) {\n      file.isUploading = true;\n      file.uploadedSize = 0;\n      file.percUploaded = 0;\n      template.files.insert(file.name, file);\n      return fakeUpload(file, template.files);\n    });\n  }\n});\n\nTemplate.presenterUploaderControl.helpers({\n  isOpen: function() {\n    return Template.instance().isOpen.get();\n  },\n  files: function() {\n    return Template.instance().files.fetch();\n  },\n  presentations: function() {\n    return Template.instance().presentations.fetch().map(function(x) {\n      return x.presentation;\n    });\n  }\n});\n\nTemplate.presenterUploaderControlFileListItem.helpers({\n  percUploaded: function() {\n    return Math.round((this.uploadedSize / this.size) * 100);\n  }\n});\n\nTemplate.presenterUploaderControlPresentationListItem.events({\n  'click [data-action-show]': function(event, template) {\n    return console.info('Should show the file `' + this.name + '`');\n  },\n  'click [data-action-delete]': function(event, template) {\n    return console.info('Should delete the file `' + this.name + '`');\n  }\n});\n","sourceMap":{"version":3,"file":"/client/views/whiteboard/whiteboard.coffee.js","sourceRoot":"","sources":["/client/views/whiteboard/whiteboard.coffee"],"names":[],"mappings":"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","sourcesContent":["# scale the whiteboard to adapt to the resized window\r\n@scaleWhiteboard = (callback) ->\r\n  adjustedDimensions = scaleSlide(getInSession('slideOriginalWidth'), getInSession('slideOriginalHeight'))\r\n  wpm = whiteboardPaperModel\r\n  wpm.scale(adjustedDimensions.width, adjustedDimensions.height)\r\n  if callback\r\n    callback()\r\n\r\nTemplate.whiteboard.helpers\r\n  presentationProgress: ->\r\n    currentPresentation = Meteor.Presentations.findOne({'presentation.current':true})\r\n    currentSlideNum = Meteor.Slides.findOne({'presentationId': currentPresentation?.presentation.id, 'slide.current':true})?.slide.num\r\n    totalSlideNum = Meteor.Slides.find({'presentationId': currentPresentation?.presentation.id})?.count()\r\n    console.log('slide', currentSlideNum)\r\n    if currentSlideNum isnt undefined\r\n      return \"#{currentSlideNum}/#{totalSlideNum}\"\r\n    else\r\n      return ''\r\n  isPollStarted: ->\r\n    if BBB.isPollGoing(getInSession('userId'))\r\n      return true\r\n    else\r\n      return false\r\n\r\n  hasNoPresentation: ->\r\n    Meteor.Presentations.findOne({'presentation.current':true})\r\n\r\nTemplate.whiteboard.events\r\n  'click .whiteboardFullscreenButton': (event, template) ->\r\n    enterWhiteboardFullscreen()\r\n\r\n  'click .exitFullscreenButton': (event, template) ->\r\n    if document.exitFullscreen\r\n      document.exitFullscreen()\r\n    else if document.mozCancelFullScreen\r\n      document.mozCancelFullScreen()\r\n    else if document.webkitExitFullscreen\r\n      document.webkitExitFullscreen()\r\n\r\n  'click .sadEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.sadEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"sad\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .happyEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.happyEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"happy\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .confusedEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.confusedEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"confused\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .neutralEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.neutralEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"neutral\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .awayEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.awayEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"away\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .raiseHandEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.raiseHandEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"raiseHand\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .activeEmojiButton': (event) ->\r\n    if $('.activeEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"none\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .FABTriggerButton': (event) ->\r\n    $('.FABTriggerButton').blur()\r\n    toggleEmojisFAB()\r\n\r\nTemplate.whiteboardControls.events\r\n  'click .whiteboard-buttons-slide > .prev':(event) ->\r\n    BBB.goToPreviousPage()\r\n\r\n  'click .whiteboard-buttons-slide > .next':(event) ->\r\n    BBB.goToNextPage()\r\n\r\n  'click .switchSlideButton': (event) ->\r\n    $('.tooltip').hide()\r\n\r\nTemplate.polling.events\r\n  'click .pollButtons': (event) ->\r\n    _key = @.label\r\n    _id = @.answer\r\n    BBB.sendPollResponseMessage(_key, _id)\r\n\r\nTemplate.polling.rendered = ->\r\n  scaleWhiteboard()\r\n\r\nTemplate.polling.destroyed = ->\r\n  setTimeout(scaleWhiteboard, 0)\r\n\r\nTemplate.whiteboardControls.rendered = ->\r\n  scaleWhiteboard()\r\n\r\nTemplate.whiteboardControls.destroyed = ->\r\n  setTimeout(scaleWhiteboard, 0)\r\n\r\nTemplate.whiteboard.rendered = ->\r\n  $('#whiteboard').resizable\r\n    handles: 'e'\r\n    minWidth: 150\r\n    resize: () ->\r\n      adjustChatInputHeight()\r\n    start: () ->\r\n      if $('#chat').width() / $('#panels').width() > 0.2 # chat shrinking can't make it smaller than one fifth of the whiteboard-chat area\r\n        $('#whiteboard').resizable('option', 'maxWidth', $('#panels').width() - 200) # gives the chat enough space (200px)\r\n      else\r\n        $('#whiteboard').resizable('option', 'maxWidth', $('#whiteboard').width())\r\n    stop: () ->\r\n      $('#whiteboard').css('width', 100 * $('#whiteboard').width() / $('#panels').width() + '%') # transforms width to %\r\n      $('#whiteboard').resizable('option', 'maxWidth', null)\r\n\r\n  # whiteboard element needs to be available\r\n  Meteor.NotificationControl = new NotificationControl('notificationArea')\r\n\r\n  $(document).foundation() # initialize foundation javascript\r\n\r\nTemplate.presenterUploaderControl.created = ->\r\n  this.isOpen = new ReactiveVar(false);\r\n  this.files = new ReactiveList({\r\n    sort: (a, b) ->\r\n      # Put the ones who still uploading first\r\n      (a.isUploading == b.isUploading) ? 0 : a.isUploading ? -1 : 1;\r\n  });\r\n  this.presentations = Meteor.Presentations.find({},\r\n  {\r\n    sort: {'presentation.current': -1, 'presentation.name': 1}\r\n    fields: {'presentation': 1}\r\n  });\r\n\r\nfakeUpload = (file, list) ->\r\n  setTimeout (->\r\n    file.uploadedSize = file.uploadedSize + (Math.floor(Math.random() * file.size + file.uploadedSize)/10)\r\n    unless file.size > file.uploadedSize\r\n      file.uploadedSize = file.size\r\n      file.isUploading = false\r\n\r\n    list.update(file.name, file)\r\n\r\n    if file.isUploading == true\r\n      fakeUpload(file, list)\r\n    else\r\n      # TODO: Here we should remove and update te presentation on mongo\r\n      list.remove(file.name)\r\n  ), 200\r\n\r\nTemplate.presenterUploaderControl.events\r\n  'click .js-open':(event, template) ->\r\n    template.isOpen.set(true);\r\n\r\n  'click .js-close':(event, template) ->\r\n    template.isOpen.set(false);\r\n\r\n  'dragover [data-dropzone]':(e) ->\r\n    e.preventDefault()\r\n    $(e.currentTarget).addClass('hover')\r\n\r\n  'dragleave [data-dropzone]':(e) ->\r\n    e.preventDefault()\r\n    $(e.currentTarget).removeClass('hover')\r\n\r\n  'drop [data-dropzone], change [data-dropzone] > input[type=\"file\"]':(e, template) ->\r\n    e.preventDefault();\r\n    files = (e.originalEvent.dataTransfer || e.originalEvent.target).files\r\n\r\n    _.each(files, (file) ->\r\n      file.isUploading = true;\r\n      file.uploadedSize = 0;\r\n      file.percUploaded = 0;\r\n\r\n      template.files.insert(file.name, file)\r\n      fakeUpload(file, template.files)\r\n    )\r\n\r\nTemplate.presenterUploaderControl.helpers\r\n  isOpen: -> Template.instance().isOpen.get()\r\n  files: -> Template.instance().files.fetch()\r\n  presentations: -> Template.instance().presentations.fetch().map((x) -> x.presentation)\r\n\r\nTemplate.presenterUploaderControlFileListItem.helpers\r\n  percUploaded: -> Math.round((this.uploadedSize / this.size) * 100)\r\n\r\nTemplate.presenterUploaderControlPresentationListItem.events\r\n  'click [data-action-show]':(event, template) ->\r\n    console.info('Should show the file `' + this.name + '`');\r\n\r\n  'click [data-action-delete]':(event, template) ->\r\n    console.info('Should delete the file `' + this.name + '`');\r\n"]}}