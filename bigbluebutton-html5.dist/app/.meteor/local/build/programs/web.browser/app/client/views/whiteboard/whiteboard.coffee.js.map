{"version":3,"sources":["meteor://ðŸ’»app/client/views/whiteboard/whiteboard.coffee"],"names":[],"mappings":"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","file":"/client/views/whiteboard/whiteboard.coffee.js","sourcesContent":["# scale the whiteboard to adapt to the resized window\r\n@scaleWhiteboard = (callback) ->\r\n  adjustedDimensions = scaleSlide(getInSession('slideOriginalWidth'), getInSession('slideOriginalHeight'))\r\n  wpm = whiteboardPaperModel\r\n  wpm.scale(adjustedDimensions.width, adjustedDimensions.height)\r\n  if callback\r\n    callback()\r\n\r\nTemplate.whiteboard.helpers\r\n  presentationProgress: ->\r\n    currentPresentation = Meteor.Presentations.findOne({'presentation.current':true})\r\n    currentSlideNum = Meteor.Slides.findOne({'presentationId': currentPresentation?.presentation.id, 'slide.current':true})?.slide.num\r\n    totalSlideNum = Meteor.Slides.find({'presentationId': currentPresentation?.presentation.id})?.count()\r\n    console.log('slide', currentSlideNum)\r\n    if currentSlideNum isnt undefined\r\n      return \"#{currentSlideNum}/#{totalSlideNum}\"\r\n    else\r\n      return ''\r\n  isPollStarted: ->\r\n    if BBB.isPollGoing(getInSession('userId'))\r\n      return true\r\n    else\r\n      return false\r\n\r\n  hasNoPresentation: ->\r\n    Meteor.Presentations.findOne({'presentation.current':true})\r\n\r\nTemplate.whiteboard.events\r\n  'click .whiteboardFullscreenButton': (event, template) ->\r\n    enterWhiteboardFullscreen()\r\n\r\n  'click .exitFullscreenButton': (event, template) ->\r\n    if document.exitFullscreen\r\n      document.exitFullscreen()\r\n    else if document.mozCancelFullScreen\r\n      document.mozCancelFullScreen()\r\n    else if document.webkitExitFullscreen\r\n      document.webkitExitFullscreen()\r\n\r\n  'click .sadEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.sadEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"sad\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .happyEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.happyEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"happy\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .confusedEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.confusedEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"confused\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .neutralEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.neutralEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"neutral\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .awayEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.awayEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"away\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .raiseHandEmojiButton.inactiveEmojiButton': (event) ->\r\n    if $('.raiseHandEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"raiseHand\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .activeEmojiButton': (event) ->\r\n    if $('.activeEmojiButton').css('opacity') is '1'\r\n      BBB.setEmojiStatus(BBB.getMeetingId(), getInSession('userId'), getInSession('userId'), getInSession('authToken'), \"none\")\r\n      $('.FABTriggerButton').blur()\r\n      toggleEmojisFAB()\r\n\r\n  'click .FABTriggerButton': (event) ->\r\n    $('.FABTriggerButton').blur()\r\n    toggleEmojisFAB()\r\n\r\nTemplate.whiteboardControls.events\r\n  'click .whiteboard-buttons-slide > .prev':(event) ->\r\n    BBB.goToPreviousPage()\r\n\r\n  'click .whiteboard-buttons-slide > .next':(event) ->\r\n    BBB.goToNextPage()\r\n\r\n  'click .switchSlideButton': (event) ->\r\n    $('.tooltip').hide()\r\n\r\nTemplate.polling.events\r\n  'click .pollButtons': (event) ->\r\n    _key = @.label\r\n    _id = @.answer\r\n    BBB.sendPollResponseMessage(_key, _id)\r\n\r\nTemplate.polling.rendered = ->\r\n  scaleWhiteboard()\r\n\r\nTemplate.polling.destroyed = ->\r\n  setTimeout(scaleWhiteboard, 0)\r\n\r\nTemplate.whiteboardControls.rendered = ->\r\n  scaleWhiteboard()\r\n\r\nTemplate.whiteboardControls.destroyed = ->\r\n  setTimeout(scaleWhiteboard, 0)\r\n\r\nTemplate.whiteboard.rendered = ->\r\n  $('#whiteboard').resizable\r\n    handles: 'e'\r\n    minWidth: 150\r\n    resize: () ->\r\n      adjustChatInputHeight()\r\n    start: () ->\r\n      if $('#chat').width() / $('#panels').width() > 0.2 # chat shrinking can't make it smaller than one fifth of the whiteboard-chat area\r\n        $('#whiteboard').resizable('option', 'maxWidth', $('#panels').width() - 200) # gives the chat enough space (200px)\r\n      else\r\n        $('#whiteboard').resizable('option', 'maxWidth', $('#whiteboard').width())\r\n    stop: () ->\r\n      $('#whiteboard').css('width', 100 * $('#whiteboard').width() / $('#panels').width() + '%') # transforms width to %\r\n      $('#whiteboard').resizable('option', 'maxWidth', null)\r\n\r\n  # whiteboard element needs to be available\r\n  Meteor.NotificationControl = new NotificationControl('notificationArea')\r\n\r\n  $(document).foundation() # initialize foundation javascript\r\n\r\nTemplate.presenterUploaderControl.created = ->\r\n  this.isOpen = new ReactiveVar(false);\r\n  this.files = new ReactiveList({\r\n    sort: (a, b) ->\r\n      # Put the ones who still uploading first\r\n      (a.isUploading == b.isUploading) ? 0 : a.isUploading ? -1 : 1;\r\n  });\r\n  this.presentations = Meteor.Presentations.find({},\r\n  {\r\n    sort: {'presentation.current': -1, 'presentation.name': 1}\r\n    fields: {'presentation': 1}\r\n  });\r\n\r\nfakeUpload = (file, list) ->\r\n  setTimeout (->\r\n    file.uploadedSize = file.uploadedSize + (Math.floor(Math.random() * file.size + file.uploadedSize)/10)\r\n    unless file.size > file.uploadedSize\r\n      file.uploadedSize = file.size\r\n      file.isUploading = false\r\n\r\n    list.update(file.name, file)\r\n\r\n    if file.isUploading == true\r\n      fakeUpload(file, list)\r\n    else\r\n      # TODO: Here we should remove and update te presentation on mongo\r\n      list.remove(file.name)\r\n  ), 200\r\n\r\nTemplate.presenterUploaderControl.events\r\n  'click .js-open':(event, template) ->\r\n    template.isOpen.set(true);\r\n\r\n  'click .js-close':(event, template) ->\r\n    template.isOpen.set(false);\r\n\r\n  'dragover [data-dropzone]':(e) ->\r\n    e.preventDefault()\r\n    $(e.currentTarget).addClass('hover')\r\n\r\n  'dragleave [data-dropzone]':(e) ->\r\n    e.preventDefault()\r\n    $(e.currentTarget).removeClass('hover')\r\n\r\n  'drop [data-dropzone], change [data-dropzone] > input[type=\"file\"]':(e, template) ->\r\n    e.preventDefault();\r\n    files = (e.originalEvent.dataTransfer || e.originalEvent.target).files\r\n\r\n    _.each(files, (file) ->\r\n      file.isUploading = true;\r\n      file.uploadedSize = 0;\r\n      file.percUploaded = 0;\r\n\r\n      template.files.insert(file.name, file)\r\n      fakeUpload(file, template.files)\r\n    )\r\n\r\nTemplate.presenterUploaderControl.helpers\r\n  isOpen: -> Template.instance().isOpen.get()\r\n  files: -> Template.instance().files.fetch()\r\n  presentations: -> Template.instance().presentations.fetch().map((x) -> x.presentation)\r\n\r\nTemplate.presenterUploaderControlFileListItem.helpers\r\n  percUploaded: -> Math.round((this.uploadedSize / this.size) * 100)\r\n\r\nTemplate.presenterUploaderControlPresentationListItem.events\r\n  'click [data-action-show]':(event, template) ->\r\n    console.info('Should show the file `' + this.name + '`');\r\n\r\n  'click [data-action-delete]':(event, template) ->\r\n    console.info('Should delete the file `' + this.name + '`');\r\n"]}