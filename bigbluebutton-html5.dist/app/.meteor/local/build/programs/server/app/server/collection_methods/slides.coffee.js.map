{"version":3,"sources":["meteor://ðŸ’»app/server/collection_methods/slides.coffee"],"names":[],"mappings":";;;;;;;;;AAGA,IAAC,iBAAD,GAAoB,SAAC,SAAD,EAAY,UAAZ,EAAwB,WAAxB;AACnB;AAAA,mBAAiB,UAAU,CAAC,KAAX,CAAiB,GAAjB,CAAsB,GAAvC;AAAA,EAEA,MAAM,CAAC,MAAM,CAAC,MAAd,CAAqB;AAAA,IAAC,gBAAgB,cAAjB;AAAA,IAAiC,iBAAiB,IAAlD;GAArB,EAA8E;AAAA,IAAC,MAAM;AAAA,MAAC,iBAAiB,KAAlB;KAAP;GAA9E,CAFA;AAAA,EAKA,0BAA0B,SAA1B,EAAqC,UAArC,CALA;SAOA,qBAAqB,SAArB,EAAgC,cAAhC,EAAgD,WAAhD,EARmB;AAAA,CAApB;;AAAA,IAWC,qBAAD,GAAwB,SAAC,SAAD,EAAY,cAAZ,EAA4B,WAA5B;AACvB;AAAA,MAAO;;;YAAP;AACC,YACC;AAAA,iBAAW,SAAX;AAAA,MACA,gBAAgB,cADhB;AAAA,MAEA,OACC;AAAA,sBAAc,WAAW,CAAC,YAA1B;AAAA,QACA,UAAU,WAAW,CAAC,QADtB;AAAA,QAEA,KAAK,WAAW,CAAC,GAFjB;AAAA,QAGA,UAAU,WAAW,CAAC,QAHtB;AAAA,QAIA,SAAS,WAAW,CAAC,OAJrB;AAAA,QAKA,SAAY,WAAW,CAAC,OAAZ,KAAyB,MAA5B,GAA2C,WAAW,CAAC,OAAvD,GAAoE,WAAW,CAAC,OALzF;AAAA,QAMA,SAAS,WAAW,CAAC,OANrB;AAAA,QAOA,IAAI,WAAW,CAAC,EAPhB;AAAA,QAQA,aAAa,WAAW,CAAC,WARzB;AAAA,QASA,SAAS,WAAW,CAAC,OATrB;AAAA,QAUA,WAAW,WAAW,CAAC,SAVvB;OAHD;KADD;WAgBA,KAAK,MAAM,CAAC,MAAM,CAAC,MAAd,CAAqB,KAArB,EAjBN;GADuB;AAAA,CAXxB;;AAAA,IAgCC,0BAAD,GAA6B,SAAC,SAAD,EAAY,OAAZ;AAC5B;AAAA,MAAG,uBAAe,iBAAf,IAA4B;;;aAA/B;AACC,SAAK,MAAM,CAAC,MAAM,CAAC,OAAd,CAAsB;AAAA,MAAC,WAAW,SAAZ;AAAA,MAAuB,YAAY,OAAnC;KAAtB,CAAL;AACA,QAAG,UAAH;AACC,YAAM,CAAC,MAAM,CAAC,MAAd,CAAqB,EAAE,CAAC,GAAxB;aACA,MAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,uBAAuB,OAAvB,GAAiC,SAAjC,GAA6C,SAA7D,EAFD;KAFD;GAD4B;AAAA,CAhC7B;;AAAA,IAwCC,sBAAD,GAAyB,SAAC,SAAD;AACxB,MAAG,iBAAH;WACC,MAAM,CAAC,MAAM,CAAC,MAAd,CAAqB;AAAA,MAAC,WAAW,SAAZ;KAArB,EAA6C,MAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,2CAAyC,SAAzC,GAAmD,GAAnE,CAA7C,EADD;GAAA;WAGC,MAAM,CAAC,MAAM,CAAC,MAAd,CAAqB,EAArB,EAAyB,MAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,2CAAhB,CAAzB,EAHD;GADwB;AAAA,CAxCzB","file":"/server/collection_methods/slides.coffee.js","sourcesContent":["# --------------------------------------------------------------------------------------------\n# Private methods on server\n# --------------------------------------------------------------------------------------------\n@displayThisSlide = (meetingId, newSlideId, slideObject) ->\n\tpresentationId = newSlideId.split(\"/\")[0] # grab the presentationId part of the slideId\n\t# change current to false for the old slide\n\tMeteor.Slides.update({presentationId: presentationId, \"slide.current\": true}, {$set: {\"slide.current\": false}})\n\t# for the new slide: remove the version which came with presentation_shared_message from the Collection\n\t# to avoid using old data (this message contains everything we need for the new slide)\n\tremoveSlideFromCollection(meetingId, newSlideId)\n\t# add the new slide to the collection\n\taddSlideToCollection(meetingId, presentationId, slideObject)\n\n\n@addSlideToCollection = (meetingId, presentationId, slideObject) ->\n\tunless Meteor.Slides.findOne({meetingId: meetingId, \"slide.id\": slideObject.id})?\n\t\tentry =\n\t\t\tmeetingId: meetingId\n\t\t\tpresentationId: presentationId\n\t\t\tslide:\n\t\t\t\theight_ratio: slideObject.height_ratio\n\t\t\t\ty_offset: slideObject.y_offset\n\t\t\t\tnum: slideObject.num\n\t\t\t\tx_offset: slideObject.x_offset\n\t\t\t\tcurrent: slideObject.current\n\t\t\t\timg_uri: if slideObject.svg_uri isnt undefined then slideObject.svg_uri else slideObject.png_uri\n\t\t\t\ttxt_uri: slideObject.txt_uri\n\t\t\t\tid: slideObject.id\n\t\t\t\twidth_ratio: slideObject.width_ratio\n\t\t\t\tswf_uri: slideObject.swf_uri\n\t\t\t\tthumb_uri: slideObject.thumb_uri\n\n\t\tid = Meteor.Slides.insert(entry)\n\t\t#Meteor.log.info \"added slide id =[#{id}]:#{slideObject.id} in #{meetingId}. Now there are #{Meteor.Slides.find({meetingId: meetingId}).count()} slides in the meeting\"\n\n@removeSlideFromCollection = (meetingId, slideId) ->\n\tif meetingId? and slideId? and Meteor.Slides.findOne({meetingId: meetingId, \"slide.id\": slideId})?\n\t\tid = Meteor.Slides.findOne({meetingId: meetingId, \"slide.id\": slideId})\n\t\tif id?\n\t\t\tMeteor.Slides.remove(id._id)\n\t\t\tMeteor.log.info \"----removed slide[\" + slideId + \"] from \" + meetingId\n\n# called on server start and meeting end\n@clearSlidesCollection = (meetingId) ->\n\tif meetingId?\n\t\tMeteor.Slides.remove({meetingId: meetingId}, Meteor.log.info \"cleared Slides Collection (meetingId: #{meetingId}!\")\n\telse\n\t\tMeteor.Slides.remove({}, Meteor.log.info \"cleared Slides Collection (all meetings)!\")\n\n# --------------------------------------------------------------------------------------------\n# end Private methods on server\n# --------------------------------------------------------------------------------------------\n"]}