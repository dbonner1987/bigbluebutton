{"version":3,"sources":["meteor://ðŸ’»app/server/collection_methods/meetings.coffee"],"names":[],"mappings":";;;;;;;;;AAIA,IAAC,uBAAD,GAA0B,SAAC,SAAD,EAAY,IAAZ,EAAkB,oBAAlB,EAAwC,SAAxC,EAAmD,QAAnD,EAA6D,QAA7D;AAGzB;SAAA,MAAM,MAAM,CAAC,QAAQ,CAAC,MAAhB,CAAuB;AAAA,IAAC,WAAU,SAAX;GAAvB,EAA8C;AAAA,IAAC,MAAM;AAAA,MAC1D,aAAY,IAD8C;AAAA,MAE1D,sBAAsB,oBAFoC;AAAA,MAG1D,wBAAwB,KAHkC;AAAA,MAI1D,WAAW,SAJ+C;AAAA,MAK1D,UAAU,QALgD;AAAA,MAM1D,kBAEC;AAAA,4BAAoB,KAApB;AAAA,QACA,YAAY,KADZ;AAAA,QAEA,YAAY,KAFZ;AAAA,QAGA,YAAY,MAAM,CAAC,MAAM,CAAC,UAH1B;AAAA,QAIA,cAAc,KAJd;AAAA,QAKA,mBAAmB,KALnB;AAAA,QAMA,wBAAwB,KANxB;OARyD;KAAP;GAA9C,EAeF;WAAA,SAAC,GAAD,EAAM,UAAN;AACH;AAAA,UAAG,6BAAH;AACC,gBAAQ,SAAC,GAAD;AACP,gBAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,qBAAmB,SAAnC;iBACA,MAFO;QAAA,CAAR;eAGA,MAAM,QAAN,EAJD;OAAA;AAMC,cAAM,CAAC,GAAG,CAAC,KAAX,CAAiB,kBAAjB;eACA,WAPD;OADG;IAAA;EAAA,QAfE,EAHmB;AAAA,CAA1B;;AAAA,IA+BC,wBAAD,GAA2B,SAAC,SAAD;AAC1B,MAAG,iBAAH;WACC,MAAM,CAAC,QAAQ,CAAC,MAAhB,CAAuB;AAAA,MAAC,WAAW,SAAZ;KAAvB,EACC,MAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,6CAA2C,SAA3C,GAAqD,GAArE,CADD,EADD;GAAA;WAIC,MAAM,CAAC,QAAQ,CAAC,MAAhB,CAAuB,EAAvB,EAA2B,MAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,6CAAhB,CAA3B,EAJD;GAD0B;AAAA,CA/B3B;;AAAA,IAwCC,4BAAD,GAA+B,SAAC,SAAD,EAAY,QAAZ;AAC9B;AAAA,MAAG;;YAAH;AACC,UAAM,CAAC,GAAG,CAAC,IAAX,CAAgB,oBAAkB,SAAlB,GAA4B,+CAA5C;AAAA,IAEA,qBAAqB,SAArB,CAFA;AAAA,IAKA,sBAAsB,SAAtB,CALA;AAAA,IAQA,sBAAsB,SAAtB,CARA;AAAA,IAWA,6BAA6B,SAA7B,CAXA;AAAA,IAcA,oBAAoB,SAApB,CAdA;AAAA,IAiBA,wBAAwB,SAAxB,CAjBA;WAmBA,WApBD;GAAA;AAsBC,YAAQ,SAAC,aAAD;AACP,YAAM,CAAC,GAAG,CAAC,KAAX,CAAkB,sCAAoC,SAAtD;aACA,gBAFO;IAAA,CAAR;WAGA,MAAM,QAAN,EAzBD;GAD8B;AAAA,CAxC/B","file":"/server/collection_methods/meetings.coffee.js","sourcesContent":["# --------------------------------------------------------------------------------------------\n# Private methods on server\n# --------------------------------------------------------------------------------------------\n\n@addMeetingToCollection = (meetingId, name, intendedForRecording, voiceConf, duration, callback) ->\n\t#check if the meeting is already in the collection\n\n\tobj = Meteor.Meetings.upsert({meetingId:meetingId}, {$set: {\n\t\tmeetingName:name\n\t\tintendedForRecording: intendedForRecording\n\t\tcurrentlyBeingRecorded: false # default value\n\t\tvoiceConf: voiceConf\n\t\tduration: duration\n\t\troomLockSettings:\n\t\t\t# by default the lock settings will be disabled on meeting create\n\t\t\tdisablePrivateChat: false\n\t\t\tdisableCam: false\n\t\t\tdisableMic: false\n\t\t\tlockOnJoin: Meteor.config.lockOnJoin\n\t\t\tlockedLayout: false\n\t\t\tdisablePublicChat: false\n\t\t\tlockOnJoinConfigurable: false # TODO\n\t}}, (err, numChanged) =>\n\t\tif numChanged.insertedId?\n\t\t\tfunct = (cbk) ->\n\t\t\t\tMeteor.log.info \"__added MEETING #{meetingId}\"\n\t\t\t\tcbk()\n\t\t\tfunct(callback)\n\t\telse\n\t\t\tMeteor.log.error \"nothing happened\"\n\t\t\tcallback()\n\t)\n\n\n\n@clearMeetingsCollection = (meetingId) ->\n\tif meetingId?\n\t\tMeteor.Meetings.remove({meetingId: meetingId},\n\t\t\tMeteor.log.info \"cleared Meetings Collection (meetingId: #{meetingId}!\")\n\telse\n\t\tMeteor.Meetings.remove({}, Meteor.log.info \"cleared Meetings Collection (all meetings)!\")\n\n\n#clean up upon a meeting's end\n@removeMeetingFromCollection = (meetingId, callback) ->\n\tif Meteor.Meetings.findOne({meetingId: meetingId})?\n\t\tMeteor.log.info \"end of meeting #{meetingId}. Clear the meeting data from all collections\"\n\t\t# delete all users in the meeting\n\t\tclearUsersCollection(meetingId)\n\n\t\t# delete all slides in the meeting\n\t\tclearSlidesCollection(meetingId)\n\n\t\t# delete all shapes in the meeting\n\t\tclearShapesCollection(meetingId)\n\n\t\t# delete all presentations in the meeting\n\t\tclearPresentationsCollection(meetingId)\n\n\t\t# delete all chat messages in the meeting\n\t\tclearChatCollection(meetingId)\n\n\t\t# delete the meeting\n\t\tclearMeetingsCollection(meetingId)\n\n\t\tcallback()\n\telse\n\t\tfunct = (localCallback) ->\n\t\t\tMeteor.log.error (\"Error! There was no such meeting #{meetingId}\")\n\t\t\tlocalCallback()\n\t\tfunct(callback)\n\n\n\n# --------------------------------------------------------------------------------------------\n# end Private methods on server\n# --------------------------------------------------------------------------------------------\n"]}